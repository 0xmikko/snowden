{"ast":null,"code":"import _objectSpread from \"/Users/mikhail/Coding/snowden/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/mikhail/Coding/snowden/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/mikhail/Coding/snowden/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/mikhail/Coding/snowden/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/mikhail/Coding/snowden/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/mikhail/Coding/snowden/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/mikhail/Coding/snowden/front/src/components/DataLoaders/DataLoaderDetail.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport * as actions from '../../actions/dataLoader';\nimport { getComponentSearch, getDataDetails } from \"../../reducers\";\nimport * as status from \"../../config\";\nexport var DataLoaderDetails =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(DataLoaderDetails, _Component);\n\n  function DataLoaderDetails() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, DataLoaderDetails);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(DataLoaderDetails)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      hash: 0\n    };\n\n    _this.updateData = function () {\n      // Get Resource & API call path\n      // New_api is used for loading defaults for new objects\n      var api = _this.props.new_api || _this.props.api;\n      var params = {\n        query: _this.props.componentSearch[_this.props.resource + _this.props.id]\n      };\n\n      _this.props.updateDetailDataLoader(api, _this.props.resource, _this.props.id, params);\n    };\n\n    return _this;\n  }\n\n  _createClass(DataLoaderDetails, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.updateData();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState, snapshot) {\n      if (this.props.componentSearch[this.props.resource + this.props.id] !== prevProps.componentSearch[this.props.resource + this.props.id]) {\n        this.updateData();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var id = this.props.id;\n      var resource = this.props.resource;\n\n      if (this.props.dataDetails === undefined || this.props.dataDetails[resource] === undefined || this.props.dataDetails[resource][id] === undefined || this.props.dataDetails[resource][id].status === status.STATUS_LOADING) {\n        return \"Loading...\";\n      }\n\n      var currentDataDetails = this.props.dataDetails[resource][id];\n\n      if (currentDataDetails.status === status.STATUS_FAILURE) {\n        return \"Ooops! Something went wrong!\";\n      }\n\n      var data = currentDataDetails.data;\n      var children = this.props.children;\n      var childrenProps = {\n        data: data,\n        api: this.props.api,\n        id: id,\n        updateData: this.updateData\n      };\n      var childrenWithProps = React.Children.map(children, function (child) {\n        return React.cloneElement(child, childrenProps);\n      });\n      return childrenWithProps;\n    }\n  }]);\n\n  return DataLoaderDetails;\n}(Component);\n;\nDataLoaderDetails.propTypes = {\n  api: PropTypes.string.isRequired,\n  resource: PropTypes.string.isRequired,\n  id: PropTypes.number.isRequired\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    dataDetails: getDataDetails(state),\n    componentSearch: getComponentSearch(state)\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    getDetailDataLoader: function getDetailDataLoader(resource, api, id) {\n      return dispatch(actions.getDataLoaderDetail(resource, api, id));\n    },\n    updateDetailDataLoader: function updateDetailDataLoader(resource, api, id, params) {\n      return dispatch(actions.getDataLoaderDetail(resource, api, id, true, params));\n    }\n  };\n};\n\nexport var DataLoaderDetailWrapperComponent = function DataLoaderDetailWrapperComponent(props) {\n  var DetailDataLoader = connect(mapStateToProps, mapDispatchToProps)(DataLoaderDetails);\n  var InputComponent = props.component;\n  var id = props.id !== undefined ? props.id : props.match.params.id; //if (props.api === '/api/options/') return \"HUI\";\n\n  var updatedProps = _objectSpread({}, props, {\n    api: props.api,\n    resource: props.resource,\n    page: true,\n    id: id,\n    new_api: props.new_api\n  });\n\n  var children = props.children;\n  var childrenWithProps = React.Children.map(children, function (child) {\n    return React.cloneElement(child, updatedProps);\n  });\n  return React.createElement(DetailDataLoader, Object.assign({}, updatedProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }), childrenWithProps);\n};\n\nvar DetailDataLoaderWrapper = function DetailDataLoaderWrapper(InputComponent, api, resource, new_api) {\n  return (\n    /*#__PURE__*/\n    function (_React$Component) {\n      _inherits(_class, _React$Component);\n\n      function _class() {\n        _classCallCheck(this, _class);\n\n        return _possibleConstructorReturn(this, _getPrototypeOf(_class).apply(this, arguments));\n      }\n\n      _createClass(_class, [{\n        key: \"render\",\n        value: function render() {\n          return React.createElement(DataLoaderDetailWrapperComponent, Object.assign({\n            id: this.props.id,\n            api: api,\n            resource: resource,\n            component: InputComponent,\n            new_api: new_api\n          }, this.props, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131\n            },\n            __self: this\n          }), React.createElement(InputComponent, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 139\n            },\n            __self: this\n          }));\n        }\n      }]);\n\n      return _class;\n    }(React.Component)\n  );\n};\n\nexport default DetailDataLoaderWrapper;","map":{"version":3,"sources":["/Users/mikhail/Coding/snowden/front/src/components/DataLoaders/DataLoaderDetail.js"],"names":["React","Component","connect","PropTypes","actions","getComponentSearch","getDataDetails","status","DataLoaderDetails","state","hash","updateData","api","props","new_api","params","query","componentSearch","resource","id","updateDetailDataLoader","prevProps","prevState","snapshot","dataDetails","undefined","STATUS_LOADING","currentDataDetails","STATUS_FAILURE","data","children","childrenProps","childrenWithProps","Children","map","child","cloneElement","propTypes","string","isRequired","number","mapStateToProps","mapDispatchToProps","dispatch","getDetailDataLoader","getDataLoaderDetail","DataLoaderDetailWrapperComponent","DetailDataLoader","InputComponent","component","match","updatedProps","page","DetailDataLoaderWrapper"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport {connect} from \"react-redux\";\n\nimport PropTypes from \"prop-types\";\n\nimport * as actions from '../../actions/dataLoader'\nimport {getComponentSearch, getDataDetails} from \"../../reducers\";\nimport * as status from \"../../config\";\n\n\nexport class DataLoaderDetails extends Component {\n\n    state = {\n        hash: 0\n    }\n\n    componentDidMount() {\n        this.updateData()\n    }\n    \n    updateData = () => {\n        // Get Resource & API call path\n        // New_api is used for loading defaults for new objects\n        const api = this.props.new_api || this.props.api;\n        const params = {query: this.props.componentSearch[this.props.resource + this.props.id]}\n        this.props.updateDetailDataLoader(api, this.props.resource, this.props.id, params);\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (this.props.componentSearch[this.props.resource + this.props.id] !== prevProps.componentSearch[this.props.resource + this.props.id]) {\n                this.updateData();\n            }\n    }\n\n    render() {\n\n            const { id } = this.props;\n            const { resource }  = this.props;\n\n            if (this.props.dataDetails === undefined ||\n                this.props.dataDetails[resource] === undefined ||\n                this.props.dataDetails[resource][id] === undefined ||\n                this.props.dataDetails[resource][id].status === status.STATUS_LOADING) {\n                return \"Loading...\";\n            }\n\n            const currentDataDetails = this.props.dataDetails[resource][id];\n\n            if (currentDataDetails.status === status.STATUS_FAILURE) {\n                return \"Ooops! Something went wrong!\";\n            }\n\n            const data = currentDataDetails.data;\n\n            const { children } = this.props;\n\n            const childrenProps = {\n                data: data,\n                api: this.props.api,\n                id: id,\n                updateData: this.updateData\n\n            };\n\n            const childrenWithProps = React.Children.map(children, child =>\n              React.cloneElement(child, childrenProps)\n            );\n            return childrenWithProps;\n        }\n\n\n};\n\nDataLoaderDetails.propTypes = {\n    api: PropTypes.string.isRequired,\n    resource: PropTypes.string.isRequired,\n    id: PropTypes.number.isRequired\n}\n\n\nconst mapStateToProps = (state) => ({\n    dataDetails:          getDataDetails(state),\n    componentSearch:    getComponentSearch(state)\n\n});\n\nconst mapDispatchToProps = dispatch => ({\n    getDetailDataLoader:      (resource, api, id) => dispatch(actions.getDataLoaderDetail(resource, api, id)),\n    updateDetailDataLoader:    (resource, api, id, params) => dispatch(actions.getDataLoaderDetail(resource, api, id, true, params))\n\n});\n\n\nexport const DataLoaderDetailWrapperComponent = (props) => {\n\n    const DetailDataLoader = connect(mapStateToProps, mapDispatchToProps)(DataLoaderDetails);\n    const InputComponent = props.component;\n    const id = (props.id !== undefined) ? props.id : props.match.params.id;\n\n    //if (props.api === '/api/options/') return \"HUI\";\n\n\n    const updatedProps = {\n        ...props,\n        api: props.api,\n        resource: props.resource,\n        page: true,\n        id: id,\n        new_api: props.new_api\n\n    }\n\n    const { children } = props;\n\n    const childrenWithProps = React.Children.map(children, child =>\n          React.cloneElement(child, updatedProps)\n        );\n\n    return <DetailDataLoader {...updatedProps }>\n                {childrenWithProps}\n            </DetailDataLoader>\n}\n\n\nconst   DetailDataLoaderWrapper = (InputComponent, api, resource, new_api) => {\n\n    return class extends React.Component {\n\n        render() {\n\n            return <DataLoaderDetailWrapperComponent\n                        id={ this.props.id }\n                        api={ api }\n                        resource = { resource }\n                        component = { InputComponent }\n                        new_api = { new_api }\n                        {...this.props}\n            >\n                <InputComponent/>\n            </DataLoaderDetailWrapperComponent>\n        }\n    }\n\n};\n\n\nexport default DetailDataLoaderWrapper;"]},"metadata":{},"sourceType":"module"}